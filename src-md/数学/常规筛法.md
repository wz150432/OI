# 筛法

筛法（Sieve）是快速筛出一定范围内的质数的算法。



## 一、埃拉托斯特尼筛法

埃氏筛的核心思想是 **「标记合数」**：从最小的质数 $2$ 开始，将每个质数的所有倍数标记为合数，未被标记的数即为质数。

埃氏筛的时间复杂度为 $O(n \log \log n)$，接近线性。证明涉及数论中的调和级数，直观理解：每个质数 $p$ 的标记次数为 $n/p$，总操作数约为 $n(1/2 + 1/3 + 1/5 + \dots + 1/p)$（质数倒数和），而该和的极限为 $\log \log n$。

```cpp
void Eratosthenes_Sieve(int n) {
    vis[1] = true;
    for (int i = 2; i <= n / i; i ++ )
        if (!vis[i])
            for (int j = i + i; j <= n; j += i)
                vis[j] = true;
}
```



## 二、欧拉筛

埃氏筛虽高效，但存在重复标记问题（例如 $12$ 会被 $2$ 和 $3$ 分别标记）。欧拉筛通过保证每个合数只被其最小质因子标记一次，将时间复杂度优化至严格线性 $O(n)$。



```cpp
void Euler_Sieve(int n) {
    vis[1] = true;
    for (int i = 2; i <= n; i ++ ) {
        if (!vis[i]) primes[ ++ cnt] = i;
        for (int j = 1; primes[j] <= n / i; j ++ ) {
            vis[i * primes[j]] = true;
            if (i % primes[j] == 0) break;
        }
    }
}
```



## 例题

[P3912](https://www.luogu.com.cn/problem/P3912)

[P3383](https://www.luogu.com.cn/problem/P3383)



## 推荐的练习

[P2568](https://www.luogu.com.cn/problem/P2568)

[P10495](https://www.luogu.com.cn/problem/P10495)

[UVA10140](https://www.luogu.com.cn/problem/UVA10140)

[P1463](https://www.luogu.com.cn/problem/P1463)

[P1072](https://www.luogu.com.cn/problem/P1072)
